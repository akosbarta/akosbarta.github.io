<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<style type="text/css">

* {
	margin: 0px;
	padding: 0px;
	font-family: Helvetica;

}

body {
	background: #666;  /* fallback for old browsers */
}

h3 {
	margin: 60px 0px;
	text-align: center;
	color: #eee;

}

h6 {
	margin: 40px auto;
	text-align: center;
	color: #ddd;
}

main {
	background: #eee;
	width: 1000px;
	border-radius: 5px;
	min-height: 400px;
	margin: 60px auto;
	padding: 40px;
	color: #808080;
	word-wrap: break-word;
}
</style>
<title>5th R homework</title>
</head>
<body>
<h3># 5th R homework</h1>
<main>
	<pre>
		<code class="prettyprint">
 
#Problem 1

func1 <- function(x) {
  ifelse(x<4,-(x-2)^2+4,ifelse(x>=5,-(1/2)*(x-7.4)^2+3,0))
}

D(expression(-(x-2)^2+4),"x")
D(expression(0*x),"x")
D(expression(-(1/2)*(x-7.4)^2+3),"x")
integrate(function(x)-(1/2)*(x-7.4)^2+3,lower=0, upper=Inf)

func1_i <- function(x) {
  ifelse(x<4,2*x^2-(x^3)/3,ifelse(x>=5,-0.16666*x^3+3.7*x^2-24.38*x+60.9,10.666))
}


func1_d <- function(x) {
  ifelse(x<4,-(2 * (x - 2)),ifelse(x>=5,-((1/2) * (2 * (x - 7.4))),0))
}

curve(func1_i,xlim=c(0,10))
curve(func1,xlim=c(0,10))
curve(func1_d,xlim=c(0,10))


#Problem 2

D(D(expression(1/x),"x"),"x")
D(expression(exp(1/x)),"x")
curve(-exp(-x))

#(b)

plotit <- function(f,x1,x2) {
  y1 <- f(x1)
  y2 <- f(x2)
  linear <- function(i) {
    ((y2-y1)/(x2-x1))*(i-x1)+y1
  }
  curve(f,xlim=c(x1-1,x2+1))
  curve(linear,xlim = c(x1,x2),add=TRUE)
}

f1 <- function(x)-x^2+x+4
f2 <- function(x)1/x
f3 <- function(x)exp(x)
f4 <- function(x)-exp(x^-1)

plotit(f4,1,4)


#Problem 3

polyDeriv <- function(x,a) {
  if (length(which(a != 0)) >= 1) {
    equ <- NULL
    for(i in seq(1,length(a))) {
      if (a[i] != 0) {
        if (a[i] < 0) {
          separator <- ""
        } else {
          separator <- "+"
        }
        if (i == 1) {
          equ <- paste(equ,a[i],sep="")
        } 
        else if (i == 2) {
          if (a[i] == 1 || a[i] == -1) {
            if (a[i] == -1) { separator = "-"}
            equ <- paste(equ,"x",sep=separator)
          } else {
            tempequ <- paste(a[i],"*x",sep="")
            equ <- paste(equ,tempequ,sep=separator)
          }
        }
        else {
          if (a[i] == 1 || a[i] == -1) {
            tempequ <- paste("x^",i-1,sep="")
            if (a[i] == -1) { separator = "-"}
            equ <- paste(equ,tempequ,sep=separator)
          } else {
            tempequ <- paste(a[i],"*x^",i-1,sep="")
            equ <- paste(equ,tempequ,sep=separator)
          }
        }
      }
    }
    if (substr(equ, 0, 1) == "+") {
      equ <- substring(equ, 2)
    }
    equ <- parse(text=equ)
    print(D(equ,"x"))
    deriv <- D(equ,"x")
    
    derivate <- function(x){
      eval(deriv)
    }
    derivate(x)
    
  } else {
    FALSE 
  }
}

polyDeriv(x = 1:3, a = c(2, 0, 1, 2))

polyDeriv1 <- function(x,a) {
  equ <- c()
  for(i in seq(2,length(a))) {
    if(a[i]*(i-1) != 0) {
      if (i > 3) {
        tempequ <- paste(a[i]*(i-1),"*x^",(i-2),sep="")
        if(a[i]*(i-1) < 0) {
          equ <- paste(equ,tempequ,sep="")
        } else {
          equ <- paste(equ,tempequ,sep = "+")
        }
      } else if (i == 3) {
        tempequ <- paste(a[i]*(i-1),"*x",sep="")
        if(a[i]*(i-1) < 0) {
          equ <- paste(equ,tempequ,sep="")
        } else {
          equ <- paste(equ,tempequ,sep = "+")
        }
      }
      else {
        tempequ <- paste(a[i]*(i-1),sep="")
        if(a[i]*(i-1) < 0) {
          equ <- paste(equ,tempequ,sep="")
        } else {
          equ <- paste(equ,tempequ,sep = "+")
        }
      }
    }
  }
  if (substr(equ, 0, 1) == "+") {
    equ <- substring(equ, 2)
  }
  print(equ)
  derivate <- function(x){
    eval(parse(text=equ))
  }
  derivate(x)
}

polyDeriv1(x = 1:3, a = c(2, -1, 1, 2))

#Problem 4
small_number <- 1/10000000
fPrime <- function(f,x) {
  (f(x+small_number)-f(x))/small_number
}
func4 <- function(x) { tan(x) }
fPrime(func4,3)

analytic <- function(x) eval(D(expression(tan(x)),"x"))
analytic(3)

#Problem 5

#(a)
curve(100*log(1000/x),xlim=c(0,1000))

#(b)
curve(x*100*log(1000/x),xlim=c(0,1000))

D(expression(x*100*log(1000/x)),"x")


#Problem 7

C = Y - I - X + M
M = C + I + X - Y


#Problem 8

#(a)

func8 <- function(x) {
  cos(x)
}

a8 <- 0

spec_deriv <- function(f,which_order) {
  deriv_row <- c(f)
  for(i in seq(1,which_order)) {
    parsed <- deriv_row[i]
    deriv_row <- c(deriv_row,D(parsed,"x"))
  }
  return(deriv_row[which_order])
}
################################ -

f <- function(x) cos(x)
n <- 10
xs <- seq(-4,4,.005)

derivative <- function(fun, n){
  for(i in 1:n){
    body(fun) <- D(body(fun), "x")
  }
  return(fun)
}

taylor1 <- function (nvalue, a = 0) {
  xaxis <- c()
  yaxis <- c()
  for (xvaluesindex in seq(-4,4,by=.005)) {
    sumit <- 0
    for (nloop in 1:nvalue) {
      sumit <- sumit + (derivative(f, nloop)(xvaluesindex)/(factorial(nloop)))*(xvaluesindex - a)^(nloop)
    }
    sumit <- f(xvaluesindex) + sumit
    xaxis <- c(xaxis,xvaluesindex)
    yaxis <- c(yaxis,sumit)
  }
  list(x = xaxis, y = yaxis)
}
taylor1(n,0)

plot(taylor1(n,0),type="l",col="red")
  plot(cos,add=TRUE,xlim=c(-4,4))


##################### ^

fapprox2 <- c()
  for (i in 0:4) {
    derivit <- function(x){eval(spec_deriv(expression(cos(x)),i+1))}
    fapprox2 <- paste(fapprox2,paste(derivit(i),"/",factorial(i),"*(x-",a8,")^",i,sep=""),sep = "+")
  }
  print(fapprox2)
rm(x)
x <- 0:4
plot(x,fapprox1(x))





curve(1-1/2*x^2+1/24*x^4,xlim=c(-4,4))

for(i in seq(1,5)) {
  derivit <- function(x){eval(spec_deriv(expression(cos(x)),i))}
  print(derivit(a8))
}
  
spec_deriv(expression(cos(x)),4)

func8(a8) + cos(a8)/factorial(0)+(x-a8)^0 + -sin(a8)/factorial(1)+(x-a8)^1
 
 
 
+ D(expression(func8),"x")/factorial(0)+(x-a8)^0
+ D(expression(func8),"x")/factorial(0)+(x-a8)^0


		</code>
	</pre>
</main>
<h6>#&copy; Copyright 2019 - Akos Barta</h2>
</body>
</html>