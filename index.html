<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<style type="text/css">

* {
	margin: 0px;
	padding: 0px;
	font-family: Helvetica;

}

body {
	background: #666;  /* fallback for old browsers */
}

h3 {
	margin: 60px 0px;
	text-align: center;
	color: #eee;

}

h6 {
	margin: 40px auto;
	text-align: center;
	color: #ddd;
}

main {
	background: #eee;
	width: 1000px;
	border-radius: 5px;
	min-height: 400px;
	margin: 60px auto;
	padding: 40px;
	color: #808080;
}
</style>
<title>4th R homework</title>
</head>
<body>
<h3># 4th R homework</h1>
<main>
	<pre>
		<code class="prettyprint">
#Problem 1

#(a)

demand <- function(price) {
  pmax(0,15 - price*1.5)
}

?pmax

expenditure <- function(price) {
  pmax(0,15 - price*1.5)*price
}

curve(expenditure(x),xlim=c(0,30))
curve(demand(x),xlim=c(0,30),add=TRUE,col="red")

#(b)
demand_b <- function(price) {
pmax(0,15*0.8^price)
}

expenditure_b <- function(price) {
  pmax(0,15*0.8^price)*price
}

curve(expenditure_b(x),xlim=c(0,30),add=TRUE,lty="dashed")
curve(demand_b(x),xlim=c(0,30),add=TRUE,col="red",lty="dashed")

#Problem 2

pascal <- function(x) {
c(choose(x,seq(0,x)))
}

pascal(16)


#Problem 3

count_chars_in_table <- function(v1,v2) {
  length(which(match(unlist(strsplit(tolower(v1),NULL), use.names=FALSE),v2,nomatch=0)>0))
}
count_chars_in_table("Wien",letters[1:13])


#Problem 4

no_of_odds <- function(x) {
  length(which(x%%2==1))
}
no_of_odds(seq(1,6))


#Problem 5
x <- seq(-2,5,by=.1)
#(a)

curve(4-(3*x^3),xlim=c(-7,7),ylim=c(-7,7))
curve(((x-4)/(-3))^(1/3),xlim=c(-7,7),add=TRUE)
curve(-((x-4)/(3))^(1/3),xlim=c(-7,7),add=TRUE)
curve(x-0,add=TRUE,col="green")
abline(h=0,v=0,col="red")

4-(3*(((x-4)/(-3))^(1/3))^3)

#(b)
curve(1+x^2,xlim=c(0,7),ylim=c(0,7))
curve(sqrt(x-1),xlim=c(0,7),ylim=c(0,7),add=TRUE)
curve(x-0,add=TRUE,col="green")
abline(h=0,v=0,col="red")

sqrt((1+x^2)-1)

#(c)

func5c <- function(x) {
  ifelse(x>1,log(x^2),(exp(x)-exp(1)))
}

func5c_inverse <- function(x) {
  ifelse(x>0,exp(x/2),log(((exp(1))+x)))
}


rm(x)

func5c_inverse(func5c(x))

curve(func5c(x),xlim=c(-4,8),ylim=c(-3,8))
curve(func5c_inverse(x),xlim=c(-4,8),add=TRUE)
curve(x-0,add=TRUE,col="green")
abline(v=1)
abline(h=0)

#Problem 7
polyPrint <- function(a) {
  if (length(which(a != 0)) >= 1) {
    equ <- NULL
    for(i in seq(1,length(a))) {
      if (a[i] != 0) {
        if (a[i] < 0) {
          separator <- ""
        } else {
          separator <- "+"
        }
        if (i == 1) {
          equ <- paste(equ,a[i],sep="")
        } 
        else if (i == 2) {
          if (a[i] == 1 || a[i] == -1) {
            if (a[i] == -1) { separator = "-"}
            equ <- paste(equ,"x",sep=separator)
          } else {
            tempequ <- paste(a[i],"*x",sep="")
            equ <- paste(equ,tempequ,sep=separator)
          }
        }
        else {
          if (a[i] == 1 || a[i] == -1) {
            tempequ <- paste("x^",i-1,sep="")
            if (a[i] == -1) { separator = "-"}
            equ <- paste(equ,tempequ,sep=separator)
          } else {
            tempequ <- paste(a[i],"*x^",i-1,sep="")
            equ <- paste(equ,tempequ,sep=separator)
          }
        }
      }
    }
    if (substr(equ, 0, 1) == "+") {
      equ <- substring(equ, 2)
    }
    print(equ)
  } else {
   FALSE 
  }
}

polyPrint(c(88,1,0,-1,0,-2))

?unlist
?sum

?is.na


		</code>
	</pre>
</main>
<h6>#&copy; Copyright 2019 - Akos Barta</h2>
</body>
</html>