<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<style type="text/css">

* {
	margin: 0px;
	padding: 0px;
	font-family: Helvetica;

}

body {
	background: #666;  /* fallback for old browsers */
}

h3 {
	margin: 60px 0px;
	text-align: center;
	color: #eee;

}

h6 {
	margin: 40px auto;
	text-align: center;
	color: #ddd;
}

main {
	background: #eee;
	width: 1000px;
	border-radius: 5px;
	min-height: 400px;
	margin: 60px auto;
	padding: 40px;
	color: #808080;
	word-wrap: break-word;
}
</style>
<title>5th R homework</title>
</head>
<body>
<h3># 5th R homework</h1>
<main>
	<pre>
		<code class="prettyprint">
#Problem 3

pascal <- function(x) {
  c(choose(x,seq(0,x)))
}

#(a)

(0.5)^(2) * (0.5)^(7) * choose(9,2)
(0.5)^(1) * (0.5)^(8) * choose(9,1)
(0.5)^(0) * (0.5)^(9) * choose(9,0)

pascal(9)
sum(pascal(9)[1:3]) / sum(pascal(9))

#(b)

(0.5)^(4) * (0.5)^(14) * choose(18,4)
(0.5)^(3) * (0.5)^(15) * choose(18,3)
(0.5)^(2) * (0.5)^(16) * choose(18,2)
(0.5)^(1) * (0.5)^(17) * choose(18,1)
(0.5)^(0) * (0.5)^(18) * choose(18,0)

(0.5)^(4) * (0.5)^(14) * choose(18,4) + (0.5)^(3) * (0.5)^(15) * choose(18,3) + (0.5)^(2) * (0.5)^(16) * choose(18,2) + (0.5)^(1) * (0.5)^(17) * choose(18,1) + (0.5)^(0) * (0.5)^(18) * choose(18,0)

pascal(18)
sum(pascal(18))

sum(pascal(18)[seq(1,5)]) / sum(pascal(18))


#Problem 4

male_prob <- 1/2.2
female_prob <- 1.2/2.2

sum( choose(6,seq(3,6)) * male_prob^seq(3,6) * female_prob^(6-seq(3,6)))

pbinom(3,6,c(1/2.2,1.2/2.2))

choose(6,3) * male_prob^3 * female_prob^3
choose(6,4) * male_prob^4 * female_prob^2
choose(6,5) * male_prob^5 * female_prob^1
choose(6,6) * male_prob^6 * female_prob^0

#Problem 5

#(a)

probs <- c(.2,.3,.1,.15,.25)
strat1 <- c(5,11,13,15.5,16)
strat2 <- c(-4,15,17.5,20.8,20)

expected <- sum(probs*strat1)
expected
variance <- sum(probs*(strat1-expected)^2)
variance
utility <- expected - sqrt(variance)
print(utility)

expected <- sum(probs*strat2)
expected
variance <- sum(probs*(strat2-expected)^2)
variance
utility <- expected - sqrt(variance)
print(utility)

# They will implement the first strategy.

#(b)
expected1 <- mean(sample(strat1, size=1000000, replace=TRUE, prob=probs))
variance1 <- mean(sample((strat1-expected1)^2, size=1000000, replace=TRUE, prob=probs))
print(expected1)
print(variance1)
print(expected1 - sqrt(variance1))

mean(sample(strat2, size=100000, replace=TRUE, prob=probs))

mean(sample(c(1,2,3,4,5),replace=TRUE,prob=c(2000,400,400,600,100),size=100000))

# Problem 6

#(a)

p_a <- 0/50000
p_b <- 1000/50000 
p_c <- (50000-11311)/50000
p_d <- 11/50000

p_a
p_b
p_c
p_d

#(b)

p_aUb <- p_a + p_b - (0)
p_aMb <- 0
p_bUc <- p_b + p_c - (0)
p_bMc <- 0
p_cUd <- p_c + p_d - (0)

p_aUb
p_aMb
p_bUc
p_bMc
p_cUd

#(c)

total_scratch <- 50000
win_prob <- c(1,10,300,1000,10000,50000-(1+10+300+1000+10000))/total_scratch
profit <- c(10000,900,32,4,2,0)-2
expected <- sum(win_prob*profit)

win_prob <- c(1,10,300,1000,10000)/total_scratch
payout <- c(10000,900,32,4,2)
expected <- sum(win_prob*payout)-2

variance <- sum(win_prob*(payout-expected)^2)
print(expected)
print(variance)

expected_check <- mean(sample(payout, size=1000000, replace=TRUE, prob=win_prob))
expected_check


#Problem 7

#(a)
correct_prob <- 1/5
incorrect_prob <- 4/5
sum( choose(20,seq(11,20)) * correct_prob^seq(11,20) * incorrect_prob^(20-seq(11,20)) )

#(b)
length(
  which(
    sample(
      0:20,
      size = 1000000,
      replace = TRUE,
      prob = choose(20,seq(0,20)) * correct_prob^seq(0,20) * incorrect_prob^(20-seq(0,20)) 
      ) > 10 
    )
  )/1000000

#Problem 8

isconvex <- function(f,x1,x2,lambda) {
  equ <- c()
  y1 <- f(x1)
  y2 <- f(x2)
  linear <- function(i) {
    ((y2-y1)/(x2-x1))*(i-x1)+y1
  }
  equ <- c(equ,f(lambda*x1+(1 - lambda)*x2) - lambda*f(x1) - (1 - lambda)*f(x2))
  if (length(which(equ > 0)) == 0) {
    print(TRUE)
    color <- "green"
  } else {
    print(FALSE)
    color <- "red"
  }
  curve(f,xlim=c(x1,x2))
  curve(linear,xlim = c(x1,x2),col=color,add=TRUE)
}
isconvex(function(x){x^3}, -.5, 1, seq(0,1,.001))

D(expression(x^3),"x")
integrate(x^2)

D(D(expression(-x^2^x),"x"),"x")
curve(eval(D(D(expression(-x^4),"x"),"x")),xlim=c(-2,0))
D(D(expression(x),"x"),"x")
uniroot(function(x){-x^3+2},c(-5,5))

isconvex <- function(f,x1,x2,lambda) {
  equ <- c(f(lambda*x1+(1 - lambda)*x2) - lambda*f(x1) - (1 - lambda)*f(x2))
  if (length(which(equ > 0)) == 0) {
    TRUE
  } else {
    FALSE
  }

}
isconvex(function(x){x^2}, -2, 2, seq(0,1,.001))


# isconvex <- function(thefunc, x1, x2) {
#   inside_func <- function(x) { eval(parse(text=thefunc)) }
#   y1 <- inside_func(x1)
#   y2 <- inside_func(x2)
#   linear <- function(i) {
#     ((y2-y1)/(x2-x1))*(i-x1)+y1
#   }
#   curve(inside_func,xlim = c(x1-1,x2+1),add=TRUE)
#   curve(linear,xlim = c(x1,x2),add=TRUE,col="green")
#   k <- seq(x1,x2,by=(x2-x1)/1000000)
#   if (length(which(linear(k) > inside_func(k))) >= 999999) {
#     TRUE
#   } else {
#     FALSE
#   }
# }
# 
# isconvex("x^3",-3,3)

#(b)

isconvex <- function(f,x1,x2,lambda) {
  y1 <- f(x1)
  y2 <- f(x2)
  linear <- function(i) {
    ((y2-y1)/(x2-x1))*(i-x1)+y1
  }
  equ <- c(f(lambda*x1+(1 - lambda)*x2) - lambda*f(x1) - (1 - lambda)*f(x2))
  if (length(which(equ > 0)) == 0) {
    print(TRUE)
    color <- "green"
  } else {
    print(FALSE)
    color <- "red"
  }
  curve(f,xlim=c(x1,x2))
  curve(linear,xlim = c(x1,x2),col=color,add=TRUE)
}
isconvex(function(x){ifelse(x<0,-x^4,ifelse(x>1,exp(x) - exp(1) + 1,x))}, -1, 3, seq(0,1,.001))
isconvex(function(x){x^2},0,2,seq(0,1,.0001))

coeff <- c()
i_vect <- c()
n_vect <- c()

for (n in seq(-20,-1,by=.1)) {
  for (i in seq(1,14,by=.01)) {
    result <- isconvex(function(x){ifelse(x<0,-x^4,ifelse(x>1,exp(x) - exp(1) + 1,x))}, n, i, seq(0,1,.001))
    if (result == TRUE) {
      print(i)
      coeff <- c(coeff, abs(i/n))
      i_vect <- c(i_vect, i)
      n_vect <- c(n_vect, n)
      break
    }
  }
}
coeff
plot(n_vect,i_vect)

data.frame(as.table(setNames(n_vect, i_vect)))
curve(3.6208*log(x) + 2.89,xlim=c(2,10))

test_first <- -20
3.6208*log(abs(test_first)) + 2.89

test_first <- -100
isconvex(function(x){ifelse(x<0,-x^4,ifelse(x>1,exp(x) - exp(1) + 1,x))}, test_first, 3.6208*log(abs(test_first)) + 2.89, seq(0,1,.001))




		</code>
	</pre>
</main>
<h6>#&copy; Copyright 2019 - Akos Barta</h2>
</body>
</html>