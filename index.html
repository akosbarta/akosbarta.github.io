<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<style type="text/css">

* {
	margin: 0px;
	padding: 0px;
	font-family: Helvetica;

}

body {
	background: #42275a;  /* fallback for old browsers */
	background: -webkit-linear-gradient(to right, #734b6d, #42275a);  /* Chrome 10-25, Safari 5.1-6 */
	background: linear-gradient(to right, #734b6d, #42275a); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
}

h1 {
	margin: 60px 0px;
	text-align: center;
	color: #eee;

}

h2 {
	margin: 40px auto;
}

main {
	background: #eee;
	width: 1000px;
	border-radius: 5px;
	min-height: 400px;
	margin: 60px auto;
	padding: 40px;
	color: #808080;
}
</style>
<title>3rd R homework</title>
</head>
<body>
<h1>3rd R homework</h1>
<h2>&copy; Copyright 2019 - Akos Barta</h2>
<main>
	<pre>
		<code class="prettyprint">
#Problem 1

#(a)

demand <- function(price) {
  pmax(0,15 - price*1.5)
}

expenditure <- function(price) {
  pmax(0,15 - price*1.5)*price
}

curve(expenditure(x),xlim=c(0,30))
curve(demand(x),xlim=c(0,30),add=TRUE,col="red")

#(b)
demand_b <- function(price) {
pmax(0,15*0.8^price)
}

expenditure_b <- function(price) {
  pmax(0,15*0.8^price)*price
}

curve(expenditure_b(x),xlim=c(0,30),add=TRUE,lty="dashed")
curve(demand_b(x),xlim=c(0,30),add=TRUE,col="red",lty="dashed")

#Problem 2

pascal <- function(x) {
  returnit <- c()
  for (i in seq(0,x)) {
    returnit <- c(returnit,choose(x,i))
  }
  returnit
}

pascal(6)


#Problem 3

count_chars_in_table <- function(v1,v2) {
  v1_a <- unlist(strsplit(tolower(v1),NULL), use.names=FALSE)
  length(which(match(v1_a,v2,nomatch=0)>0))
}
count_chars_in_table("Wien",letters[1:13])


#Problem 4

no_of_odds <- function(x) {
  length(which(x%%2==1))
}
no_of_odds(seq(1,6))


#Problem 5

#(a)

curve(4-(3*x^3),xlim=c(-7,7),ylim=c(-7,7))
curve(((x-4)/(-3))^(1/3),xlim=c(-7,7),add=TRUE)
curve(-((x-4)/(3))^(1/3),xlim=c(-7,7),add=TRUE)
curve(x-0,add=TRUE,col="green")
abline(h=0,v=0,col="red")

#(b)
curve(1+x^2,xlim=c(0,7),ylim=c(0,7))
curve(sqrt(x-1),xlim=c(0,7),ylim=c(0,7),add=TRUE)
curve(x-0,add=TRUE,col="green")
abline(h=0,v=0,col="red")

#(c)

func5c <- function(x) {
  ifelse(x>1,log(x^2),(exp(x)-exp(1)))
}

f1 <- function(x) {
  exp(x/2)
}
f2 <- function(x) {
  log(((exp(1))+x))
}
#uniroot(function(x) f1(x)-f2(x),c(,101))$root

func5c_inverse <- function(x) {
  ifelse(x>0,exp(x/2),log(((exp(1))+x)))
}
rm(x)
x <- seq(0,2,by=.01)
func5c(1)
func5c_inverse(0)
func5c_inverse(1.386294)
func5c_inverse(0.99)

points(1.00000001,func5c_inverse(1.00000001))

curve(func5c(x),xlim=c(-4,8),ylim=c(-3,8))
curve(func5c_inverse(x),xlim=c(-4,8),add=TRUE)
curve(x-0,add=TRUE,col="green")
abline(v=1)
abline(h=0)

#Problem 7
polyPrint <- function(a) {
    equ <- NULL
    for(i in seq(1,length(a))) {
      if (a[i] != 0) {
        if (a[i] < 0) {
          separator <- ""
        } else {
          separator <- "+"
        }
        if (i == 1) {
          equ <- paste(equ,a[i],sep="")
        } else {
          if (a[i] == 1) {
            tempequ <- paste("x^",i-1,sep="")
            equ <- paste(equ,tempequ,sep=separator)
          } else {
            tempequ <- paste(a[i],"*x^",i-1,sep="")
            equ <- paste(equ,tempequ,sep=separator)
          }
        }
      }
    }
    if (substr(equ, 0, 1) == "+") {
      equ <- substring(equ, 2)
    }
    print(equ)
}
polyPrint(c(10,1,-24,-3,0,21,0,0,0,0,0,0,0,11))

?unlist
?sum


		</code>
	</pre>
</main>
</body>
</html>